python pandas How to copy column values regarding an index column
Note : the question was edited and extended as it originally lacked precision .
The first example introduces the question , but should only be considered as an introduction
Having two datasets looking like :
I'd like to copy the fist dataset values regarding the index column ( and set NaN on non matching columns )
Obtaining this :
Regards
Edit :
Regarding my initial post , EdChum's answer was correct , but my question lacked precision .
The other_columns means i'd like to keep the other columns unchanged , an my goal is inserting values from dataset1 in dataset2 .
More precise example :
I'd like to retrieve
Which is a sub frame from Fuego's merge based anwser , but i don't see yet how to only keep the [ ' idx ' , ' val_x ' , ' other_y '] cols .
When you say index column , is it a column or is it really the index ?
it's not the index , it is an attribute column whose values are distinct .
See the last portion of my answer
Now your desired output no longer matches your code you posted to create the dfs , please can you edit your question so it's correct
If you have more specific suggestion i'd be glad to , i try to keep consistance across the different answers as they are interesting .
I think you should use the ` merge ` function of panda :
The result you want will be the first column .
See the doc for more one the how parameter ( set NaN , or take only left , right or both ... ) .
See ya !
EDIT :
I saw your edit and you wonder how to extract only the columns you want , but you just have to pass the columns you want to the merge :
( don't worry , the drop command won't delete the column of df2 , it will return a DataFrame without with column )
That will result in 4 rows not 3 like the OP's desired output
It depends on the how parameter , I edited to put " right " because I didn't see it was demanding only 3 rows . But I think he can understand this with the documentation .
It's still incomplete as there are clashes in the column values so that would introduce column_x and column_y additional columns so it's still an incomplete answer , I didn't downvote but your answer is still incomplete
Okey I understand :p Thx :)
This appears to be the answer , but actually myt test doesn't run : i get a key error on df1 [ ' idx ' , ' val '] expression .
use ` reindex `
` reindex_like ` also works :
Or label-based index using ` loc ` :
If ` idx ` is really a column , then you need to call ` set_index ` first and then doc any of the above :
@USER please explain as it looks to me that it's a reindexing question
His resulting dataframe looked like if he wants to merge . Maybe I was mistaken . Or maybe he didn't put his question properly .
Yes , i think i didn't detail the question enough , i'll edit it . Thanx for this quick and interesting answer .