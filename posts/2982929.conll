plotting	O
results	O
of	O
hierarchical	O
clustering	O
ontop	O
of	O
a	O
matrix	O
of	O
data	O
in	O
python	O

How	O
can	O
I	O
plot	O
a	O
dendrogram	O
right	O
on	O
top	O
of	O
a	O
matrix	O
of	O
values	O
,	O
reordered	O
appropriately	O
to	O
reflect	O
the	O
clustering	O
,	O
in	O
Python	O
?	O

An	O
example	O
is	O
the	O
following	O
figure	O
:	O

https://publishing-cdn.elifesciences.org/07103/elife-07103-fig6-figsupp1-v2.jpg	O

I	O
use	O
scipy.cluster.dendrogram	O
to	O
make	O
my	O
dendrogram	O
and	O
perform	O
hierarchical	O
clustering	O
on	O
a	O
matrix	O
of	O
data	O
.	O

How	O
can	O
I	O
then	O
plot	O
the	O
data	O
as	O
a	O
matrix	O
where	O
the	O
rows	O
have	O
been	O
reordered	O
to	O
reflect	O
a	O
clustering	O
induced	O
by	O
the	O
cutting	O
the	O
dendrogram	O
at	O
a	O
particular	O
threshold	O
,	O
and	O
have	O
the	O
dendrogram	O
plotted	O
alongside	O
the	O
matrix	O
?	O

I	O
know	O
how	O
to	O
plot	O
the	O
dendrogram	O
in	O
scipy	O
,	O
but	O
not	O
how	O
to	O
plot	O
the	O
intensity	O
matrix	O
of	O
data	O
with	O
the	O
right	O
scale	O
bar	O
next	O
to	O
it	O
.	O

Any	O
help	O
on	O
this	O
would	O
be	O
greatly	O
appreciated	O
.	O

This	O
is	O
more	O
of	O
a	O
matplotlib	O
question	O
,	O
I've	O
retagged	O
it	O
.	O

Possible	O
duplicate	O
:	O
stackoverflow.com/questions/2455761	O

Please	O
update	O
the	O
link	O
to	O
the	O
picture	O
.	O

The	O
question	O
does	O
not	O
define	O
matrix	O
very	O
well	O
:	O
"	O
matrix	O
of	O
values	O
"	O
,	O
"	O
matrix	O
of	O
data	O
"	O
.	O

I	O
assume	O
that	O
you	O
mean	O
a	O
distance	O
matrix	O
.	O

In	O
other	O
words	O
,	O
element	O
D_ij	O
in	O
the	O
symmetric	O
nonnegative	O
N-by-N	O
distance	O
matrix	O
D	O
denotes	O
the	O
distance	O
between	O
two	O
feature	O
vectors	O
,	O
x_i	O
and	O
x_j	O
.	O

Is	O
that	O
correct	O
?	O

If	O
so	O
,	O
then	O
try	O
this	O
(	O
edited	O
June	O
13	O
,	O
2010	O
,	O
to	O
reflect	O
two	O
different	O
dendrograms	O
):	O

Dendrogram	O
and	O
distance	O
matrix	O
http://up.stevetjoa.com/dendrogram.png	O

Good	O
luck	O
!	O

Let	O
me	O
know	O
if	O
you	O
need	O
more	O
help	O
.	O

Edit	O
:	O
For	O
different	O
colors	O
,	O
adjust	O
the	O
`	O
cmap	O
`	O
attribute	O
in	O
`	O
imshow	O
`	O
.	O

See	O
the	O
scipy	O
/	O
matplotlib	O
docs	O
for	O
examples	O
.	O

That	O
page	O
also	O
describes	O
how	O
to	O
create	O
your	O
own	O
colormap	O
.	O

For	O
convenience	O
,	O
I	O
recommend	O
using	O
a	O
preexisting	O
colormap	O
.	O

In	O
my	O
example	O
,	O
I	O
used	O
`	O
YlGnBu	O
`	O
.	O

Edit	O
:	O
`	O
add_axes	O
`	O
(	O
see	O
documentation	O
here	O
)	O
accepts	O
a	O
list	O
or	O
tuple	O
:	O
`	O
(	O
left	O
,	O
bottom	O
,	O
width	O
,	O
height	O
)`	O
.	O

For	O
example	O
,	O
`	O
(	O
0.5	O
,	O
0	O
,	O
0.5	O
,	O
1	O
)`	O
adds	O
an	O
`	O
Axes	B-API
`	O
on	O
the	O
right	O
half	O
of	O
the	O
figure	O
.	O

`	O
(	O
0	O
,	O
0.5	O
,	O
1	O
,	O
0.5	O
)`	O
adds	O
an	O
`	O
Axes	B-API
`	O
on	O
the	O
top	O
half	O
of	O
the	O
figure	O
.	O

Most	O
people	O
probably	O
use	O
`	O
add_subplot	O
`	O
for	O
its	O
convenience	O
.	O

I	O
like	O
`	O
add_axes	O
`	O
for	O
its	O
control	O
.	O

To	O
remove	O
the	O
border	O
,	O
use	O
`	O
add_axes	O
([	O
left	O
,	O
bottom	O
,	O
width	O
,	O
height	O
]	O
,	O
frame_on=False	O
)`	O
.	O

See	O
example	O
here	O
.	O

This	O
is	O
a	O
great	O
question	O
.	O

A	O
couple	O
of	O
more	O
questions	O
:	O
how	O
can	O
I	O
show	O
the	O
clustering	O
of	O
the	O
samples	O
at	O
the	O
top	O
?	O

If	O
the	O
matrix	O
is	O
genes	O
by	O
samples	O
,	O
you've	O
showed	O
the	O
genes	O
on	O
the	O
left	O
but	O
I	O
want	O
to	O
show	O
the	O
samples	O
clustering	O
on	O
top	O
.	O

How	O
can	O
I	O
adjust	O
the	O
axes	O
appropriately	O
to	O
do	O
that	O
?	O

Also	O
,	O
how	O
can	O
I	O
adjust	O
the	O
color	O
map	B-API
to	O
be	O
yellow	O
to	O
blue	O
and	O
control	O
the	O
scale	O
of	O
the	O
bar	O
on	O
the	O
right	O
?	O

thanks	O
so	O
much	O
!	O

I	O
uploaded	O
a	O
figure	O
with	O
a	O
different	O
color	O
map	B-API
.	O

See	O
edit	O
.	O

Could	O
you	O
define	O
"	O
gene	O
"	O
and	O
"	O
sample	O
"	O
?	O

How	O
is	O
similarity	O
computed	O
?	O

Nevertheless	O
,	O
I	O
also	O
added	O
a	O
second	O
dendrogram	O
above	O
the	O
matrix	O
.	O

Hopefully	O
you	O
can	O
adjust	O
it	O
as	O
you	O
see	O
fit	O
.	O

You're	O
welcome	O
.	O

See	O
latest	O
edit	O
.	O

I	O
think	O
the	O
way	O
you	O
use	O
the	O
linkage	O
function	O
is	O
wrong	O
.	O

If	O
you	O
look	O
at	O
the	O
source	O
code	O
of	O
linkage()	O
,	O
if	O
the	O
first	O
parameter	O
(	O
here	O
you	O
use	O
D	O
)	O
is	O
a	O
matrix	O
,	O
it'll	O
be	O
treated	O
as	O
data	O
,	O
not	O
distance	O
.	O

To	O
input	O
distance	O
,	O
you	O
have	O
to	O
take	O
the	O
upper	O
triangle	O
of	O
D	O
and	O
make	O
it	O
into	O
a	O
one	O
dimension	O
vector	O
,	O
then	O
pass	O
it	O
to	O
linkage()	O
.	O

this	O
answer	O
is	O
very	O
helpful	O
!	O
but	O
,	O
as	O
@USER	O
mentioned	O
,	O
the	O
`	O
linkage	O
`	O
function	O
usage	O
seems	O
to	O
be	O
wrong	O
now	O
.	O
using	O
distance	O
matrix	O
,	O
convert	O
it	O
to	O
vector-form	O
distance	O
matrix	O
.	O

i.e.	O
`	O
D	O
=	O
squareform	O
(	O
D	O
)`	O
before	O
using	O
`	O
linkage	O
`	O
.	O
github.com/scipy/scipy/blob/v0.15.1/scipy/cluster	O

If	O
in	O
addition	O
to	O
the	O
matrix	O
and	O
dendrogram	O
it	O
is	O
required	O
to	O
show	O
the	O
labels	O
of	O
the	O
elements	O
,	O
the	O
following	O
code	O
can	O
be	O
used	O
,	O
that	O
shows	O
all	O
the	O
labels	O
rotating	O
the	O
x	O
labels	O
and	O
changing	O
the	O
font	O
size	O
to	O
avoid	O
overlapping	O
on	O
the	O
x	O
axis	O
.	O

It	O
requires	O
moving	O
the	O
colorbar	O
to	O
have	O
space	O
for	O
the	O
y	O
labels	O
:	O

The	O
result	O
obtained	O
is	O
this	O
(	O
with	O
a	O
different	O
color	O
map	B-API
):	O

