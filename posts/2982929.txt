plotting results of hierarchical clustering ontop of a matrix of data in python
How can I plot a dendrogram right on top of a matrix of values , reordered appropriately to reflect the clustering , in Python ? An example is the following figure :
https://publishing-cdn.elifesciences.org/07103/elife-07103-fig6-figsupp1-v2.jpg
I use scipy.cluster.dendrogram to make my dendrogram and perform hierarchical clustering on a matrix of data . How can I then plot the data as a matrix where the rows have been reordered to reflect a clustering induced by the cutting the dendrogram at a particular threshold , and have the dendrogram plotted alongside the matrix ? I know how to plot the dendrogram in scipy , but not how to plot the intensity matrix of data with the right scale bar next to it .
Any help on this would be greatly appreciated .
This is more of a matplotlib question , I've retagged it .
Possible duplicate : stackoverflow.com/questions/2455761
Please update the link to the picture .
The question does not define matrix very well : " matrix of values " , " matrix of data " . I assume that you mean a distance matrix . In other words , element D_ij in the symmetric nonnegative N-by-N distance matrix D denotes the distance between two feature vectors , x_i and x_j . Is that correct ?
If so , then try this ( edited June 13 , 2010 , to reflect two different dendrograms ):
Dendrogram and distance matrix http://up.stevetjoa.com/dendrogram.png
Good luck ! Let me know if you need more help .
Edit : For different colors , adjust the ` cmap ` attribute in ` imshow ` . See the scipy / matplotlib docs for examples . That page also describes how to create your own colormap . For convenience , I recommend using a preexisting colormap . In my example , I used ` YlGnBu ` .
Edit : ` add_axes ` ( see documentation here ) accepts a list or tuple : ` ( left , bottom , width , height )` . For example , ` ( 0.5 , 0 , 0.5 , 1 )` adds an ` Axes ` on the right half of the figure . ` ( 0 , 0.5 , 1 , 0.5 )` adds an ` Axes ` on the top half of the figure .
Most people probably use ` add_subplot ` for its convenience . I like ` add_axes ` for its control .
To remove the border , use ` add_axes ([ left , bottom , width , height ] , frame_on=False )` . See example here .
This is a great question . A couple of more questions : how can I show the clustering of the samples at the top ? If the matrix is genes by samples , you've showed the genes on the left but I want to show the samples clustering on top . How can I adjust the axes appropriately to do that ? Also , how can I adjust the color map to be yellow to blue and control the scale of the bar on the right ? thanks so much !
I uploaded a figure with a different color map . See edit . Could you define " gene " and " sample " ? How is similarity computed ? Nevertheless , I also added a second dendrogram above the matrix . Hopefully you can adjust it as you see fit .
You're welcome . See latest edit .
I think the way you use the linkage function is wrong . If you look at the source code of linkage() , if the first parameter ( here you use D ) is a matrix , it'll be treated as data , not distance . To input distance , you have to take the upper triangle of D and make it into a one dimension vector , then pass it to linkage() .
this answer is very helpful ! but , as @USER mentioned , the ` linkage ` function usage seems to be wrong now . using distance matrix , convert it to vector-form distance matrix . i.e. ` D = squareform ( D )` before using ` linkage ` . github.com/scipy/scipy/blob/v0.15.1/scipy/cluster
If in addition to the matrix and dendrogram it is required to show the labels of the elements , the following code can be used , that shows all the labels rotating the x labels and changing the font size to avoid overlapping on the x axis . It requires moving the colorbar to have space for the y labels :
The result obtained is this ( with a different color map ):